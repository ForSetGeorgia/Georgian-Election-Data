<% title @indicator.present? ? @indicator["name"] : t('.title') %>

<div id="indicator_profile" class="tabbable">

  <% if @indicator["summary"].present? %>
    <div id="indicator_summary">
      <%= simple_format(@indicator["summary"]) %>
      <hr />
    </div>
  <% end %>

  <div class="tabbable">
    <ul class="nav nav-tabs">
      <% @indicator["event_types"].each_with_index do |type, index| %>
        <li class="<%= index == @active_index ? 'active' : ''%>">
          <%= link_to type["name"], "#tab#{type["id"]}", :'data-toggle' => 'tab', :'data-id' => type["id"] %>
        </li>
      <% end %>
    </ul>
    <div class="tab-content">
      <% @indicator["event_types"].each_with_index do |type, index| %>
        <div class="tab-pane <%= index == @active_index ? 'active' : ''%>" id="<%= "tab#{type["id"]}" %>">

          <div class="row-fluid indicator_profile_filters">
            <div class="span9 clear" id="event_filter">
              <h3>
                <%= t('.event_filter_header') %>
                <% if type["events"].length > 3 %>
                  <span><%= t('.event_filter_gt_3') %></span>
                <% end %>
              </h3>
              <% type["events"].each_with_index do |event, e_index| %>
                <div style="float: left; padding: 2px 4px; margin: 2px 4px;">
                  <label for="<%= "event_#{event["id"]}" %>">
                    <%= check_box_tag "event_filter_checkboxes", event["id"], e_index < 3 ? true : false, :id => "event_#{event["id"]}" %>
                    <%= event["name"] %>
                  </label>
                </div>
              <% end %>
            </div>
            <% if @districts.present? %>
              <div class="span3">  
                <h3><%= t('.district_filter_header') %></h3>

                <div class="district_filter">
                  <select id="district_filter_<%= type["id"]%>" class="district_filter_select" data-id="<%= type["id"]%>">
                    <option value="0" selected="selected"><%= t('.all_districts_option') %></option>
                    <% @districts.each_with_index do |district, d_index| %>
                      <option value="<%= d_index%>" data-id="<%= district.common_id %>" data-shape-type-id="<%= district.shape_type_id %>"><%= district.common_name %></option>
                    <% end %>
                  </select>
                </div>
              </div>
            <% end %>

          </div>

          <div class="profile_item row-fluid">
            <% type["events"].each_with_index do |event, e_index| %>
              <div class="span4 <%= e_index < 3 ? 'active' : ''%> <%= e_index == 0 ? 'no-left-margin' : ''%>" data-id="<%= event["id"]%>">
                <div class="indicator_header">
                  <h2><%= event["name"] %></h2>
                </div>

                <h3><%= t('.summary_header') %></h3>

                <div class="indicator_summary">
                  <div class="indicator_summary_chart" data-id="<%= event["id"]%>"></div>
                </div>

                <h3><%= t('.details_header') %></h3>

                <div class="indicator_details">
                  <div class="indicator_detail_chart" data-id="<%= event["id"]%>"></div>
                </div>

              </div>
            <% end %>
          </div>
          
          <div class="indicator_table_container">
            <h3><%= t('.table_header') %></h3>
            <div class="indicator_table"></div>
          </div>

        </div>
      <% end %>
    </div>
  </div>
</div>

